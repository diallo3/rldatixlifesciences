{% set level = level + 0 %}
{% import "components/ui/_macro-icon.twig" as icons %}
{% import "/templates/components/ui/_macro-image-object.twig" as images %}
{% import "/templates/components/ui/_macro-button.twig" as buttons %}
{% import "/templates/components/ui/_macro-heading.twig" as headings %}
{% import "/templates/components/ui/_macro-badge.twig" as badges %}

<menu class="menu-list flex items-center space-x-4 lg:space-x-8 relative {{ name }}" data-level="{{ level }}">
    
	{% for item in items %}
		<li 
            x-data="{ 
                open: false 
            }"
            @mouseenter="open = true"
            @mouseleave="open = false"
            :class="scrolledFromTop ? ' py-8' : 'py-16'"
            class="font-semibold {{ item.classes|join(', ') }} {{ item.current ? 'text-white' : '' }} menu-list-item py-8 group cursor-pointer relative text-white transition-all duration-500 ease-in-out"
        >
            <div class="absolute inset-x-0 top-0 h-0.5 {{ item.current ? 'bg-dodger-blue-800' : '' }} "></div>
			{% if item.link == '#' %}
				<button class="menu-link flex space-x-1.5 text-sm":aria-expanded="open" >
					{% include "/templates/components/menu-list/menu-text.twig" %}
				</button>
			{% else %}
				<a href="{{ item.link }}" 
                    class=" flex items-center space-x-1.5 text-sm transition duration-150 ease-linear menu-link hover:text-dodger-blue-500" 
                    target="{{ item.target }}"
                    :aria-expanded="open"
                >
                    {% include "/templates/components/menu-list/menu-text.twig" %}
                </a>
			{% endif %}

                {# #}
                {% if item.children  %}
                <div 
                    class="origin-top-right absolute top-[80%] left-1/2 -translate-x-1/2  max-w-fit bg-wood-smoke-950 border-2 border-[#1E336A] px-10 py-4 text- text-left rounded shadow-xl shadow-black/40 [& z-50] [x-cloak]:hidden overflow-hidden"
                    x-show="open"
                    x-transition:enter="transition ease-out duration-200 transform"
                    x-transition:enter-start="opacity-0 -translate-y-2"
                    x-transition:enter-end="opacity-100 translate-y-0"
                    x-transition:leave="transition ease-out duration-200"
                    x-transition:leave-start="opacity-100"
                    x-transition:leave-end="opacity-0"
                    x-cloak
                    @focusout="await $nextTick();!$el.contains($focus.focused()) && (open = false)"
                   data-level="{{ level + 1 }}"
                >
                    {% if item.meta('mega_menu_item') %}    
                        <div class="absolute inset-0">
                            {{ images.imageObject({
                                src: theme.link ~ '/public/img/img-glow-blue.png',
                                alt: 'icon',
                                class: 'w-full h-full'
                            })}}
                        </div>
                        <menu class="relative flex gap-8 px-4 py-2">
                            {% for item in item.children %}
                                <li class="{{ item.classes.join('') }} relative space-y-2 flex flex-col grow text-sm font-montserrat w-full">
                                    <a href="{{ item.link }}" class="block py-0.5 text-dodger-blue-500 transition duration-150 ease-in-out whitespace-nowrap  hover:text-dodger-blue-500 uppercase">{{ item.title }}</a>
                                    <ul class="flex-none min-w-52 text-dodger-blue-600">
                                        {% for child in item.children %}
                                            <li class="">
                                                <a href="{{ child.link }}" class="block py-2 antialiased text-white hover:text-dodger-blue-200">{{ child.title }}</a>
                                            </li>
                                        {% endfor %}
                                        
                                    </ul>
                                </li>
                            {% endfor %}

                        </menu>
                     {% else %}
                    <menu class="relative">
                        {% for item in item.children %}
                            <li class="{{ item.classes.join('') }} text-sm">
                                <a href="{{ item.link }}" class="block py-1.5 menu-link">{{ item.title }}</a>
                            </li>
                        {% endfor %}
                    </menu>
                {% endif %}  
                </div>
                {% endif %}

		</li>
	{% endfor %}
</menu>